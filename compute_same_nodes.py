import numpy as np

# create a test array
#records_array = np.array([1, 2, 3, 1, 1, 3, 4, 3, 2])
def get_lst(Mgcodes):
#list = [321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 415806521343, 415806521343, 415806521343, 415806521343, 416343392255, 416343392255, 416343392255, 416343392255, 416343392255, 422248972287, 422248972287, 422248972287, 422248972287, 422248972287, 422785843199, 422785843199, 422785843199, 422785843199, 424396455935, 424396455935, 424396455935, 424396455935, 424933326847, 424933326847, 424933326847, 448018776063, 448018776063, 448018776063, 448018776063, 448555646975, 448555646975, 448555646975, 448555646975, 448555646975, 450166259711, 450166259711, 450166259711]
    records_array = np.array(Mgcodes)

    # creates an array of indices, sorted by unique element
    idx_sort = np.argsort(records_array)

    # sorts records array so all unique elements are together
    sorted_records_array = records_array[idx_sort]

    # returns the unique values, the index of the first occurrence of a value, and the count for each element
    vals, idx_start, count = np.unique(sorted_records_array, return_counts=True, return_index=True)

    # splits the indices into separate arrays
    res = np.split(idx_sort, idx_start[1:])

    #filter them with respect to their size, keeping only items occurring more than once
    vals = vals[count >= 1]
    #print(vals)
    #res = filter(lambda x: x.size >= 1, res)
    #print(res)
    return vals, res
# Mgcodes = [321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 321854111743, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 413659037695, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 414195908607, 415806521343, 415806521343, 415806521343, 415806521343, 416343392255, 416343392255, 416343392255, 416343392255, 416343392255, 422248972287, 422248972287, 422248972287, 422248972287, 422248972287, 422785843199, 422785843199, 422785843199, 422785843199, 424396455935, 424396455935, 424396455935, 424396455935, 424933326847, 424933326847, 424933326847, 448018776063, 448018776063, 448018776063, 448018776063, 448555646975, 448555646975, 448555646975, 448555646975, 448555646975, 450166259711, 450166259711, 450166259711]
# print(get_lst(Mgcodes)[1][1])
